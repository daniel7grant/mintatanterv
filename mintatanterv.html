<html>
<meta charset="UTF-8">
<head>

<script>
	
/*
	var subjects = '';
	var termcolor = {
		1 : "rgba(255, 255, 0, 0.65)",	//YELLOW
		2 : "rgba(255, 128, 0, 0.8)",	//ORANGE
		3 : "rgba(255, 0, 0, 0.7)",		//RED
		4 : "rgba(128, 0, 255, 0.65)",	//PURPLE
		5 : "rgba(0, 59, 255, 0.5)",	//BLUE
		6 : "rgba(0, 255, 0, 0.6)",		//LIGHTGREEN
		7 :	"rgba(0, 128, 0, 0.8)"		//DARKGREEN
	};

	function generate()
	{
		$.get('subjects.php', function(data){
			var source = $('#template-subject').html();
			var template = Handlebars.compile(source);
			subjects = JSON.parse(data);
			$('.subjects').html(template(subjects));
			$('.subj-down').hide();
			colorbyterm();
			if (typeof(Storage) !== "undefined" && localStorage.orderby) {
				orderby(localStorage.orderby);
			} else {
				orderby('name');
			}
		});
	}
	
	function colorbyterm()
	{
		for (var i in subjects)
		{
			$(document.getElementById(subjects[i].code)).find('.subject')
				.css('background-color', termcolor[subjects[i].term]);
		}
	}
	
	function orderby(comp)
	{
		$('.subjects > .subjcontainer').sort(function(a, b){
			if(subjects[a.id][comp] < subjects[b.id][comp]) return -1;
			else if(subjects[a.id][comp] > subjects[b.id][comp]) return 1;
			else
			{
				if(subjects[a.id][name] < subjects[b.id][name]) return -1;
				else return 1;
			}
		}).each(function(){
			$('.subjects').append(this);
		});
		console.log(subjects);
		if (typeof(Storage) !== "undefined") {
			localStorage.orderby = comp;
		}
	}
	
	$(document).ready(function() {
		generate();
		
		$('body').on('click', '.subject', function(ev) {
			if($(this).next().is(':visible'))
			{
				$('.subj-down').slideUp(200, function(){ $('.subject').removeClass('is-down'); });		
				$(this).attr('src', 'res/down.png');
			}
			else
			{
				$('.subj-down').slideUp(200);
				$('.subject').removeClass('is-down');				
				$(this).next().slideDown(200);
				$(this).addClass('is-down');
			}
			ev.stopPropagation();
		});
		
		$('body').click(function(ev){
			$('.subj-down').slideUp(200, function(){ $('.subject').removeClass('is-down'); });
		});
		
		$('body').on('dragstart', '.subjcontainer', function(ev){
			$('.subj-down').slideUp(200, function(){ $('.subject').removeClass('is-down'); });
			ev.originalEvent.dataTransfer.setData('id', this.id);
			ev.originalEvent.dataTransfer.setData('origin', JSON.stringify($(this).parent().eq(0)[0]));
			console.log(ev.originalEvent.dataTransfer.getData('origin'));
		});
		
		$('body').on('dragenter', 'td,.subjects', function(ev){		
			if(ev.originalEvent.dataTransfer.getData('origin') != JSON.stringify($(this)))
			{
				console.log(JSON.stringify($(this).eq(0)[0]));
				$(this).addClass('is-draghover');
				ev.originalEvent.preventDefault();			
			}
		});
		
		$('body').on('dragleave', 'td,.subjects', function(ev){
			$(this).removeClass('is-draghover');
		});
		
		$('body').on('drop', 'td,.subjects', function(ev){
			$(this).removeClass('is-draghover');
			var subj = ev.originalEvent.dataTransfer.getData('id');
			console.log(subj);
			$(this).append($(document.getElementById(subj)));
		});
		
		$('.sort').click(function(){
			switch($('.sort').index($(this)))
			{
				case 0 : orderby('name'); break;
				case 1 : orderby('credit'); break;
				case 2 : orderby('term'); break;
			}
		});
	});*/
	
</script>

<link rel="stylesheet" type="text/css" href="theme.css">
</head>

<body>

<div style="width:100%">
	
	<table>
		<tr>
			<td><p>1. félév</p></td>
			<td><p>2. félév</p></td>
			<td><p>3. félév</p></td>
			<td><p>4. félév</p></td>
			<td><p>5. félév</p></td>
			<td><p>6. félév</p></td>
			<td><p>7. félév</p></td>
		</tr>
	</table>
	
	<div class="footer">
		<div class="menu">
			<div>Rendezés:</div>			
			<div class="sort">Ábécé szerint</div>
			<div class="sort">Kredit szerint</div>
			<div class="sort">Félév szerint</div>
			<div>Szűrés:</div>			
			<div>(DROPDOWN)</div>
		</div>
		
		<div class="subjects">
			<bme-subject></bme-subject>
		</div>
	</div>

	<script src="https://unpkg.com/vue@2.1.10/dist/vue.js"></script>
	<script src="https://cdn.jsdelivr.net/vue.resource/1.2.1/vue-resource.min.js"></script>
	<script src="bme-subject.js"></script>
</div>



</body>

</html>